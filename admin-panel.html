<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administraci√≥n - Demo Voice</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #667eea;
            padding-bottom: 20px;
        }
        .header h1 {
            margin: 0;
            color: #333;
            font-size: 2.5rem;
        }
        .header .subtitle {
            color: #666;
            margin-top: 10px;
        }
        .admin-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
        }
        .admin-section h2 {
            margin-top: 0;
            color: #667eea;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        .btn-danger {
            background: #e74c3c;
        }
        .btn-danger:hover {
            background: #c0392b;
        }
        .btn-success {
            background: #27ae60;
        }
        .btn-success:hover {
            background: #2ecc71;
        }
        .logs-container {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            margin: 15px 0;
        }
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: 10px;
            display: inline-block;
            min-width: 200px;
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #667eea;
        }
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .status-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }
        .location-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #2196f3;
        }
        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        .code-output {
            background: #f1f3f4;
            border: 1px solid #dadce0;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
            white-space: pre-wrap;
        }
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            color: #856404;
        }
        .alert-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ†Ô∏è Panel de Administraci√≥n</h1>
            <p class="subtitle">Demo Voice - Control de Sesiones y Estad√≠sticas</p>
        </div>

        <!-- Acciones R√°pidas -->
        <div class="admin-section">
            <h2>‚ö° Acciones R√°pidas Post-Demo</h2>
            <div class="quick-actions">
                <button class="btn btn-danger" onclick="instantLogoutAll()" style="font-size: 18px; animation: pulse 2s infinite;">
                    ‚ö° LOGOUT INSTANT√ÅNEO
                </button>
                <button class="btn btn-danger" onclick="emergencyNuclearLogout()" style="font-size: 16px; background: #ff0000; margin-left: 10px;">
                    üí• NUCLEAR LOGOUT
                </button>
                <button class="btn btn-danger" onclick="invalidateAllSessions()">üö´ Generar Nueva SESSION_KEY</button>
                <button class="btn btn-success" onclick="generateNewCredentials()">üîë Nuevas Credenciales</button>
                <button class="btn" onclick="viewSessionStats()">üìä Ver Estad√≠sticas</button>
                <button class="btn" onclick="exportLogs()">üì• Exportar Logs</button>
                <button class="btn" onclick="clearAllLogs()">üóëÔ∏è Limpiar Logs</button>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #ffc107;">
                <strong>‚ö° LOGOUT INSTANT√ÅNEO:</strong> Desloguea usuarios inmediatamente (sin esperar GitHub)<br>
                <strong>üö´ Generar SESSION_KEY:</strong> Crea nueva clave para futuras invalidaciones
            </div>
        </div>

        <!-- Estad√≠sticas en Tiempo Real -->
        <div class="admin-section">
            <h2>üìä Estad√≠sticas de Acceso</h2>
            <div id="stats-container">
                <div class="stat-card">
                    <div class="stat-number" id="total-logins">0</div>
                    <div class="stat-label">Total de Accesos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="active-sessions">0</div>
                    <div class="stat-label">Sesiones Activas</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="unique-visitors">0</div>
                    <div class="stat-label">Visitantes √önicos</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="last-access">-</div>
                    <div class="stat-label">√öltimo Acceso</div>
                </div>
            </div>
        </div>

        <!-- Sistema de Logs -->
        <div class="grid">
            <div class="admin-section">
                <h2>üìã Registro de Accesos</h2>
                <div class="logs-container" id="access-logs">
                    Cargando logs de acceso...
                </div>
                <button class="btn" onclick="refreshLogs()">üîÑ Actualizar Logs</button>
            </div>

            <div class="admin-section">
                <h2>üåç Ubicaciones de Acceso</h2>
                <div id="location-info">
                    <p>Los datos de ubicaci√≥n se obtienen del navegador y IP cuando est√°n disponibles.</p>
                </div>
            </div>
        </div>

        <!-- Configuraci√≥n de Sesiones -->
        <div class="admin-section">
            <h2>‚öôÔ∏è Configuraci√≥n de Sesiones</h2>
            
            <h3>üîê Credenciales Actuales:</h3>
            <div class="code-output" id="current-credentials">
                Cargando configuraci√≥n actual...
            </div>

            <h3>üîë Generar Nueva SESSION_KEY:</h3>
            <button class="btn" onclick="generateSessionKey()">Generar Nueva Clave</button>
            <div class="code-output" id="new-session-key" style="display: none;">
                <!-- La nueva clave aparecer√° aqu√≠ -->
            </div>

            <h3>‚è∞ Configurar Timeout de Sesiones:</h3>
            <select id="session-timeout" onchange="updateSessionTimeout()">
                <option value="3600000">1 hora</option>
                <option value="21600000">6 horas</option>
                <option value="43200000">12 horas</option>
                <option value="86400000" selected>24 horas</option>
                <option value="604800000">7 d√≠as</option>
            </select>
        </div>

        <!-- Alertas del Sistema -->
        <div id="alerts-container"></div>
    </div>

    <script>
        // Sistema de administraci√≥n completo
        class AdminPanel {
            constructor() {
                this.logs = JSON.parse(localStorage.getItem('admin_access_logs') || '[]');
                this.stats = JSON.parse(localStorage.getItem('admin_stats') || '{}');
                this.init();
            }

            init() {
                this.updateStats();
                this.displayLogs();
                this.displayCurrentConfig();
                this.startAutoRefresh();
                this.logAdminAccess();
            }

            // Registrar acceso de administrador
            logAdminAccess() {
                const log = {
                    type: 'admin_access',
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    screen: `${screen.width}x${screen.height}`,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
                };

                this.logs.push(log);
                this.saveLogs();
            }

            // Invalidar todas las sesiones
            invalidateAllSessions() {
                const newSessionKey = 'auth_session_' + Date.now() + '_' + Math.random().toString(36).substring(2, 8);
                
                const log = {
                    type: 'invalidate_all',
                    timestamp: new Date().toISOString(),
                    newSessionKey: newSessionKey,
                    adminAction: true
                };

                this.logs.push(log);
                this.saveLogs();

                this.showAlert('success', `
                    üö´ Todas las sesiones ser√°n invalidadas<br>
                    üìù Nueva SESSION_KEY generada: <code>${newSessionKey}</code><br>
                    ‚ö†Ô∏è ACCI√ìN REQUERIDA: Actualizar script.js l√≠nea 8
                `);

                document.getElementById('new-session-key').style.display = 'block';
                document.getElementById('new-session-key').textContent = 
                    `const SESSION_KEY = '${newSessionKey}';`;

                return newSessionKey;
            }

            // Generar nuevas credenciales
            generateNewCredentials() {
                const timestamp = Date.now();
                const newPassword = 'secure_' + timestamp.toString().slice(-6);
                
                const credentials = {
                    username: 'admin',
                    password: newPassword,
                    generated: new Date().toISOString()
                };

                const log = {
                    type: 'new_credentials',
                    timestamp: new Date().toISOString(),
                    newPassword: newPassword,
                    adminAction: true
                };

                this.logs.push(log);
                this.saveLogs();

                this.showAlert('warning', `
                    üîë Nuevas credenciales generadas:<br>
                    üë§ Usuario: <code>admin</code><br>
                    üîí Password: <code>${newPassword}</code><br>
                    ‚ö†Ô∏è Actualizar en script.js l√≠neas 2-5
                `);

                return credentials;
            }

            // Actualizar estad√≠sticas
            updateStats() {
                const totalLogins = this.logs.filter(log => log.type === 'user_login').length;
                const adminAccesses = this.logs.filter(log => log.type === 'admin_access').length;
                const uniqueIPs = [...new Set(this.logs.map(log => log.ip).filter(Boolean))].length;
                const lastAccess = this.logs.length > 0 ? 
                    new Date(this.logs[this.logs.length - 1].timestamp).toLocaleString() : 'Nunca';

                document.getElementById('total-logins').textContent = totalLogins;
                document.getElementById('active-sessions').textContent = '?'; // Se calcular√° din√°micamente
                document.getElementById('unique-visitors').textContent = uniqueIPs || '?';
                document.getElementById('last-access').textContent = lastAccess;

                this.stats = {
                    totalLogins,
                    adminAccesses,
                    uniqueIPs,
                    lastAccess,
                    updated: new Date().toISOString()
                };

                localStorage.setItem('admin_stats', JSON.stringify(this.stats));
            }

            // Mostrar logs
            displayLogs() {
                const logsContainer = document.getElementById('access-logs');
                const recentLogs = this.logs.slice(-50).reverse(); // √öltimos 50 logs

                if (recentLogs.length === 0) {
                    logsContainer.innerHTML = 'No hay logs disponibles.';
                    return;
                }

                const logsHTML = recentLogs.map(log => {
                    const date = new Date(log.timestamp).toLocaleString();
                    const type = this.getLogTypeLabel(log.type);
                    
                    return `<div style="margin-bottom: 8px; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">
                        <strong>${date}</strong> - ${type}
                        ${log.ip ? `<br>üìç IP: ${log.ip}` : ''}
                        ${log.location ? `<br>üåç ${log.location}` : ''}
                        ${log.userAgent ? `<br>üíª ${log.userAgent.substring(0, 80)}...` : ''}
                    </div>`;
                }).join('');

                logsContainer.innerHTML = logsHTML;
            }

            getLogTypeLabel(type) {
                const labels = {
                    'user_login': 'üîì Login Usuario',
                    'user_logout': 'üîí Logout Usuario', 
                    'admin_access': 'üë®‚Äçüíº Acceso Admin',
                    'invalidate_all': 'üö´ Invalidar Sesiones',
                    'new_credentials': 'üîë Nuevas Credenciales',
                    'failed_login': '‚ùå Login Fallido'
                };
                return labels[type] || 'üìã ' + type;
            }

            // Mostrar configuraci√≥n actual
            displayCurrentConfig() {
                // Esta funci√≥n se conectar√° con el script.js principal
                const config = `
Usuario: admin
Password: [Ver en script.js l√≠nea 4]
SESSION_KEY: [Ver en script.js l√≠nea 8]
√öltima actualizaci√≥n: ${new Date().toLocaleString()}

‚ö†Ô∏è Nota: Los valores exactos est√°n en script.js por seguridad
                `;
                document.getElementById('current-credentials').textContent = config;
            }

            // Generar nueva session key
            generateSessionKey() {
                return this.invalidateAllSessions();
            }

            // Exportar logs
            exportLogs() {
                const data = {
                    logs: this.logs,
                    stats: this.stats,
                    exported: new Date().toISOString()
                };

                const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `demo-voice-logs-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);

                this.showAlert('success', 'üì• Logs exportados exitosamente');
            }

            // Limpiar todos los logs
            clearAllLogs() {
                if (confirm('‚ö†Ô∏è ¬øEst√°s seguro de que quieres eliminar TODOS los logs?\n\nEsta acci√≥n no se puede deshacer.')) {
                    this.logs = [];
                    this.stats = {};
                    localStorage.removeItem('admin_access_logs');
                    localStorage.removeItem('admin_stats');
                    
                    this.updateStats();
                    this.displayLogs();
                    
                    this.showAlert('success', 'üóëÔ∏è Todos los logs han sido eliminados');
                }
            }

            // Mostrar alertas
            showAlert(type, message) {
                const alertsContainer = document.getElementById('alerts-container');
                const alertDiv = document.createElement('div');
                alertDiv.className = `alert alert-${type}`;
                alertDiv.innerHTML = message;
                
                alertsContainer.appendChild(alertDiv);
                
                // Auto-remove despu√©s de 10 segundos
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.parentNode.removeChild(alertDiv);
                    }
                }, 10000);
            }

            // Guardar logs
            saveLogs() {
                localStorage.setItem('admin_access_logs', JSON.stringify(this.logs));
            }

            // Auto-refresh cada 30 segundos
            startAutoRefresh() {
                setInterval(() => {
                    this.updateStats();
                }, 30000);
            }

            // Refrescar logs manualmente
            refreshLogs() {
                this.updateStats();
                this.displayLogs();
                this.showAlert('success', 'üîÑ Logs actualizados');
            }
        }

        // Inicializar panel de administraci√≥n
        const admin = new AdminPanel();

        // Funciones globales para los botones
        function invalidateAllSessions() {
            admin.invalidateAllSessions();
        }

        function generateNewCredentials() {
            admin.generateNewCredentials();
        }

        function viewSessionStats() {
            admin.updateStats();
            admin.showAlert('info', 'üìä Estad√≠sticas actualizadas');
        }

        function exportLogs() {
            admin.exportLogs();
        }

        function clearAllLogs() {
            admin.clearAllLogs();
        }

        function generateSessionKey() {
            admin.generateSessionKey();
        }

        function refreshLogs() {
            admin.refreshLogs();
        }

        function updateSessionTimeout() {
            const timeout = document.getElementById('session-timeout').value;
            admin.showAlert('warning', `‚è∞ Timeout configurado a ${parseInt(timeout)/3600000} horas`);
        }

        // Funci√≥n de logout instant√°neo 
        function instantLogoutAll() {
            if (!confirm('‚ö†Ô∏è LOGOUT INSTANT√ÅNEO\n\nEsta acci√≥n desloguear√° INMEDIATAMENTE a todos los usuarios activos.\n\n¬øContinuar?')) {
                return;
            }

            // Opci√≥n 1: Abrir p√°gina especializada
            const openSpecialPage = confirm('Selecciona el m√©todo:\n\nOK = P√°gina especializada (recomendado)\nCancel = Logout inmediato aqu√≠');
            
            if (openSpecialPage) {
                window.open('admin-instant-logout.html', '_blank', 'width=900,height=700');
            } else {
                executeInstantLogoutHere();
            }
        }

        // üí• FUNCI√ìN DE EMERGENCIA NUCLEAR
        function emergencyNuclearLogout() {
            if (!confirm('üí• NUCLEAR LOGOUT\n\n¬°ESTA ES LA OPCI√ìN M√ÅS AGRESIVA!\n\nEliminar√° TODO el localStorage/sessionStorage y forzar√° logout inmediato.\n\n¬øCONTINUAR?')) {
                return;
            }
            
            admin.showAlert('danger', 'üí• EJECUTANDO NUCLEAR LOGOUT...');
            
            // LIMPIAR TODO - SIN EXCEPCIONES
            localStorage.clear();
            sessionStorage.clear();
            
            // Forzar todas las keys posibles
            const allPossibleKeys = [
                'authenticated_session', 'authenticated_session_v2', 'authenticated_session_secure',
                'auth_session_new', 'session_key', 'user_session', 'demo_session',
                'login_status', 'user_authenticated', 'session_active', 'auth_token',
                'access_token', 'user_token', 'demo_access', 'portal_session'
            ];
            
            allPossibleKeys.forEach(key => {
                localStorage.removeItem(key);
                sessionStorage.removeItem(key);
            });
            
            // Broadcast nuclear - M√ÅXIMA POTENCIA
            try {
                // M√©todo 1: Message
                window.postMessage({type: 'NUCLEAR_LOGOUT', timestamp: Date.now()}, '*');
                
                // M√©todo 2: Storage events m√∫ltiples
                window.dispatchEvent(new StorageEvent('storage', {key: null, oldValue: null, newValue: null}));
                window.dispatchEvent(new StorageEvent('storage', {key: 'authenticated_session', oldValue: 'true', newValue: null}));
                
                // M√©todo 3: Intentar acceso cross-window si es posible
                const allWindows = [];
                try {
                    // Esta es una t√©cnica para encontrar ventanas del mismo origen
                    if (window.opener && !window.opener.closed) {
                        window.opener.localStorage.clear();
                        window.opener.location.reload();
                    }
                } catch (e) { console.log('Cross-window access blocked:', e); }
                
                console.log('üí• NUCLEAR BROADCAST COMPLETADO');
            } catch (e) {
                console.log('üí• Error en nuclear broadcast:', e);
            }
            
            // Generar nueva SESSION_KEY
            const newSessionKey = 'auth_nuclear_' + Date.now() + '_' + Math.random().toString(36).substring(2, 8);
            
            admin.showAlert('success', `
                üí• NUCLEAR LOGOUT COMPLETADO<br>
                üßπ TODO eliminado<br>
                üîë Nueva SESSION_KEY: <code>${newSessionKey}</code><br>
                üìù Actualizar script.js l√≠nea 8:<br>
                <code>const SESSION_KEY = '${newSessionKey}';</code>
            `);
            
            console.log('üí• NUCLEAR LOGOUT EXECUTED - ALL CLEAR');
        }

        // Ejecutar logout instant√°neo en esta p√°gina
        function executeInstantLogoutHere() {
            admin.showAlert('danger', 'üö´ EJECUTANDO LOGOUT INSTANT√ÅNEO...');

            // ‚ö° FORZAR LIMPIEZA TOTAL INMEDIATA
            console.log('üö® INICIANDO LOGOUT FORZADO...');
            
            // PASO 1: Limpiar la SESSION_KEY principal PRIMERO
            localStorage.removeItem('authenticated_session');
            sessionStorage.removeItem('authenticated_session');
            console.log('‚úÖ authenticated_session ELIMINADA');
            
            // PASO 2: Lista expandida de session keys a limpiar
            const possibleKeys = [
                'authenticated_session',
                'authenticated_session_v2', 
                'authenticated_session_secure',
                'authenticated_session_secure_v2',
                'auth_session_new',
                'session_key',
                'user_session',
                'demo_session',
                'auth_secure_',
                'login_status',
                'user_authenticated',
                'session_active'
            ];

            // PASO 3: Agregar keys din√°micas
            const now = Date.now();
            for (let i = 0; i < 30; i++) {
                const timestamp = now - (i * 86400000); // √öltimos 30 d√≠as
                possibleKeys.push(`auth_session_${timestamp.toString().substring(0, 10)}`);
                possibleKeys.push(`auth_secure_${timestamp.toString().substring(0, 10)}`);
            }

            let clearedKeys = 0;

            // PASO 4: Limpiar todas las keys de sesi√≥n
            possibleKeys.forEach(key => {
                if (localStorage.getItem(key)) {
                    localStorage.removeItem(key);
                    localStorage.removeItem(key + '_timestamp');
                    clearedKeys++;
                    console.log(`üóëÔ∏è Eliminada: ${key}`);
                }
                sessionStorage.removeItem(key);
            });

            // PASO 5: Limpiar cualquier key que contenga 'session' o 'auth'
            const allKeys = Object.keys(localStorage);
            allKeys.forEach(key => {
                if (key.includes('session') || key.includes('auth') || key.includes('login')) {
                    localStorage.removeItem(key);
                    clearedKeys++;
                    console.log(`üßπ Eliminada autom√°tica: ${key}`);
                }
            });

            // PASO 6: Limpiar sessionStorage completamente
            sessionStorage.clear();
            
            // PASO 7: VERIFICACI√ìN FINAL
            const finalCheck = localStorage.getItem('authenticated_session');
            console.log(`üîç Verificaci√≥n final: authenticated_session = ${finalCheck}`);
            
            // PASO 8: FORZAR REFRESCO EN TODAS LAS P√ÅGINAS ABIERTAS
            try {
                // M√©todo 1: Broadcast local
                window.postMessage({type: 'FORCE_LOGOUT', timestamp: Date.now()}, '*');
                console.log('üì¢ Mensaje de logout enviado a todas las ventanas');
                
                // M√©todo 2: Intentar abrir y cerrar una ventana para activar storage events
                const tempWindow = window.open('', '_blank', 'width=1,height=1');
                if (tempWindow) {
                    tempWindow.localStorage.removeItem('authenticated_session');
                    tempWindow.close();
                }
                
                // M√©todo 3: Simular storage event manualmente
                window.dispatchEvent(new StorageEvent('storage', {
                    key: 'authenticated_session',
                    oldValue: 'true',
                    newValue: null,
                    url: window.location.href
                }));
                
            } catch (e) {
                console.log('‚ö†Ô∏è No se pudo enviar mensaje broadcast:', e);
            }

            // Generar nueva SESSION_KEY
            const newSessionKey = 'auth_secure_' + Date.now() + '_' + Math.random().toString(36).substring(2, 8);

            // Registrar la acci√≥n
            admin.logs.push({
                type: 'instant_logout_executed',
                timestamp: new Date().toISOString(),
                method: 'admin_panel_direct',
                keysCleared: clearedKeys,
                newSessionKey: newSessionKey,
                adminAction: true
            });
            admin.saveLogs();

            // Mostrar resultado
            admin.showAlert('success', `
                ‚úÖ LOGOUT INSTANT√ÅNEO COMPLETADO<br>
                üßπ ${clearedKeys} sessions limpiadas<br>
                üîë Nueva SESSION_KEY: <code>${newSessionKey}</code><br>
                üìù Actualizar script.js l√≠nea 8 con:<br>
                <code>const SESSION_KEY = '${newSessionKey}';</code>
            `);

            // Actualizar estad√≠sticas
            admin.updateStats();
        }

        // Detectar ubicaci√≥n si est√° disponible
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(position => {
                const location = `${position.coords.latitude.toFixed(2)}, ${position.coords.longitude.toFixed(2)}`;
                document.getElementById('location-info').innerHTML = `
                    <div class="location-info">
                        <strong>üìç Ubicaci√≥n Actual:</strong><br>
                        Coordenadas: ${location}<br>
                        Precisi√≥n: ${position.coords.accuracy}m<br>
                        <small>Esta informaci√≥n se guarda en los logs para auditor√≠a</small>
                    </div>
                `;
            });
        }
    </script>
</body>
</html>